<!DOCTYPE html>
<html>
<head>
    <title>ğŸ”§ Debug LocalStorage</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        button { padding: 10px 20px; margin: 5px; }
    </style>
</head>
<body>
    <h1>ğŸ”§ Debug LocalStorage Ğ´Ğ»Ñ "ĞŸÑƒÑ‚ÑŒ ĞĞ¿Ğ¾ÑÑ‚Ğ¾Ğ»Ğ¾Ğ²"</h1>
    
    <div id="results"></div>
    
    <button onclick="testStorage()">ğŸ§ª Ğ¢ĞµÑÑ‚ Storage</button>
    <button onclick="clearStorage()">ğŸ—‘ï¸ ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ</button>
    <button onclick="checkExisting()">ğŸ‘€ ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ</button>
    
    <script>
        const log = (message, type = 'info') => {
            const div = document.createElement('div');
            div.className = `test ${type}`;
            div.innerHTML = message;
            document.getElementById('results').appendChild(div);
            console.log(message);
        };

        const testStorage = () => {
            document.getElementById('results').innerHTML = '';
            
            try {
                log('ğŸš€ ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµĞ¼ Ñ‚ĞµÑÑ‚ localStorage...');
                
                // Ğ¢ĞµÑÑ‚ 1: Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ° localStorage
                localStorage.setItem('test-key', 'test-value');
                const testValue = localStorage.getItem('test-key');
                if (testValue === 'test-value') {
                    log('âœ… Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ localStorage Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚', 'success');
                } else {
                    log('âŒ Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ localStorage ĞĞ• Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚', 'error');
                }
                
                // Ğ¢ĞµÑÑ‚ 2: JSON Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ (ĞºĞ°Ğº Ğ² zustand)
                const testUser = {
                    id: 'test-user-123',
                    name: 'Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ',
                    timestamp: Date.now()
                };
                
                const userJson = JSON.stringify(testUser);
                localStorage.setItem('test-user', userJson);
                const storedUserJson = localStorage.getItem('test-user');
                const parsedUser = JSON.parse(storedUserJson);
                
                if (parsedUser.id === testUser.id) {
                    log('âœ… JSON storage Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚', 'success');
                } else {
                    log('âŒ JSON storage ĞĞ• Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚', 'error');
                }
                
                // Ğ¢ĞµÑÑ‚ 3: Ğ¡Ğ¸Ğ¼ÑƒĞ»ÑÑ†Ğ¸Ñ zustand persist
                const zustandData = {
                    state: {
                        user: {
                            id: 'dev-user-' + Date.now(),
                            email: 'dev@apostles.app',
                            name: 'Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº'
                        }
                    },
                    version: 0
                };
                
                localStorage.setItem('user-storage', JSON.stringify(zustandData));
                const storedZustand = localStorage.getItem('user-storage');
                const parsedZustand = JSON.parse(storedZustand);
                
                if (parsedZustand.state.user.id.startsWith('dev-user-')) {
                    log('âœ… Zustand persist ÑĞ¸Ğ¼ÑƒĞ»ÑÑ†Ğ¸Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚', 'success');
                } else {
                    log('âŒ Zustand persist ÑĞ¸Ğ¼ÑƒĞ»ÑÑ†Ğ¸Ñ ĞĞ• Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚', 'error');
                }
                
                log('ğŸ‰ Ğ’ÑĞµ Ñ‚ĞµÑÑ‚Ñ‹ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ñ‹!');
                
            } catch (error) {
                log('ğŸš¨ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°: ' + error.message, 'error');
            }
        };

        const clearStorage = () => {
            localStorage.clear();
            log('ğŸ—‘ï¸ LocalStorage Ğ¾Ñ‡Ğ¸Ñ‰ĞµĞ½', 'success');
        };

        const checkExisting = () => {
            document.getElementById('results').innerHTML = '';
            log('ğŸ‘€ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ...');
            
            // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ĞºĞ»ÑÑ‡ Ğ¾Ñ‚ zustand
            const userStorage = localStorage.getItem('user-storage');
            if (userStorage) {
                log('ğŸ“¦ ĞĞ°Ğ¹Ğ´ĞµĞ½ user-storage: ' + userStorage, 'success');
                try {
                    const parsed = JSON.parse(userStorage);
                    log('ğŸ‘¤ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ: ' + JSON.stringify(parsed.state?.user || 'Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½'), 'info');
                } catch (e) {
                    log('âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ° user-storage: ' + e.message, 'error');
                }
            } else {
                log('ğŸ“¦ user-storage Ğ¿ÑƒÑÑ‚ Ğ¸Ğ»Ğ¸ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½', 'info');
            }
            
            // ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ²ÑĞµ ĞºĞ»ÑÑ‡Ğ¸
            const keys = Object.keys(localStorage);
            log('ğŸ”‘ Ğ’ÑĞµ ĞºĞ»ÑÑ‡Ğ¸ Ğ² localStorage: ' + keys.join(', '), 'info');
        };

        // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ‚ĞµÑÑ‚ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ
        window.onload = () => {
            log('ğŸŒ Browser: ' + navigator.userAgent);
            checkExisting();
        };
    </script>
</body>
</html> 